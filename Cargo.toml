[workspace]
members = [
  ".",
  "crates/dto",
  "crates/e2e-tests",
  "crates/event-sorcery",
  "crates/execution",
  "crates/bridge",
  "crates/evm",
]
resolver = "2"

[workspace.package]
edition = "2024"
version = "0.1.0"
license = "MIT"
homepage = "https://github.com/ST0x-Technology"

[workspace.lints.rust]
unsafe_code = "forbid"

[workspace.lints.clippy]
unwrap_used = "deny"
expect_used = "deny"
enum_glob_use = "allow"

# `priority = -1` allow for allowing lints enabled by a group to be re-disabled
pedantic = { level = "deny", priority = -1 }
nursery = { level = "deny", priority = -1 }

doc_markdown = "allow"
items_after_statements = "allow"
missing_const_for_fn = "allow"
missing_docs_in_private_items = "allow"
missing_errors_doc = "allow"
missing_panics_doc = "allow"
must_use_candidate = "allow"
redundant_pub_crate = "allow"

[workspace.dependencies]
alloy = { version = "1.0.38", features = ["full", "rand", "node-bindings"] }
async-trait = "0.1.81"
cqrs-es = "0.4"
sqlite-es = { git = "https://github.com/ST0x-Technology/st0x.issuance", package = "sqlite-es" }
revm = { version = "=25.0.0", default-features = false }
# Pin wasm-bindgen version for compatibility with rain.wasm transitive dependency
wasm-bindgen = "0.2.100"
sqlx = { version = "0.8.6", features = [
  "sqlite",
  "chrono",
  "runtime-tokio-rustls",
] }
backon = { version = "1.5.1", features = ["tokio"] }
base64 = "0.22"
chrono = { version = "0.4.38", features = ["serde"] }
clap = { version = "4.5.40", features = ["derive", "env"] }
flate2 = "1.0"
httpmock = "0.8"
rain-math-float = { path = "lib/rain.orderbook/lib/rain.orderbook.interface/lib/rain.interpreter.interface/lib/rain.math.float/crates/float" }
reqwest = { version = "0.12.4", features = [
  "json",
  "rustls-tls",
  "gzip",
  "blocking",
] }
serde = { version = "1.0.197", features = ["derive"] }
serde_json = "1.0.140"
serial_test = "3.2.0"
thiserror = "2.0.12"
tokio = { version = "1.46.0", features = ["full"] }
tracing = "0.1.41"
url = { version = "2.5.4", features = ["serde"] }
urlencoding = "2.1"
rand = "0.8"
rsa = { version = "0.9.10", features = ["pem"] }
uuid = { version = "1.11", features = ["serde", "v4"] }
chrono-tz = "0.10.4"
num-traits = "0.2"
opentelemetry = "0.30.0"
opentelemetry_sdk = { version = "0.30.0", features = ["rt-tokio"] }
opentelemetry-otlp = "0.30.0"
tracing-opentelemetry = "0.31.0"
proptest = "1.7.0"
rain-error-decoding = { git = "https://github.com/rainlanguage/rain.error" }
rust_decimal = { version = "1.38.0", features = ["serde"] }
st0x-evm = { path = "crates/evm" }
num-decimal = { version = "0.2.5", default-features = false, features = [
  "num-v04",
] }

[package]
name = "st0x-hedge"
version = "0.1.0"
edition = "2024"

[features]
test-support = ["dep:bon"]

[dependencies]
alloy.workspace = true
anyhow = "1.0.98"
async-trait.workspace = true
sqlite-es.workspace = true
st0x-event-sorcery = { path = "crates/event-sorcery" }
st0x-dto = { path = "crates/dto" }
st0x-bridge = { path = "crates/bridge", features = ["cctp"] }
st0x-execution = { path = "crates/execution" }
backon.workspace = true
clap.workspace = true
futures-util = "0.3.31"
lazy_static = "1.5.0"
rain-math-float.workspace = true
serde_json.workspace = true
sqlx.workspace = true
thiserror.workspace = true
tokio.workspace = true
url.workspace = true
reqwest.workspace = true
serde.workspace = true
chrono.workspace = true
base64.workspace = true
uuid.workspace = true
tracing.workspace = true
tracing-subscriber = { version = "0.3.19", features = ["env-filter"] }
urlencoding.workspace = true
flate2.workspace = true
itertools = "0.14.0"
rand.workspace = true
rocket = { version = "0.5.1", features = ["json"] }
chrono-tz.workspace = true
aes-gcm = "0.10.3"
rust_decimal.workspace = true
num-traits.workspace = true
opentelemetry.workspace = true
opentelemetry_sdk.workspace = true
opentelemetry-otlp.workspace = true
tracing-opentelemetry.workspace = true
rain-error-decoding.workspace = true
ts-rs = { version = "11.1.0", features = [
  "chrono",
  "chrono-impl",
  "serde-compat",
] }
rocket_ws = "0.1.1"
toml = "0.9.11"
rust_decimal_macros = "1.38.0"
st0x-evm = { workspace = true, features = ["fireblocks"] }
bon = { version = "3.9.0", optional = true }

[dev-dependencies]
httpmock.workspace = true
serial_test.workspace = true
proptest.workspace = true
temp-env = "0.3.6"
tokio-tungstenite = "0.28.0"
st0x-event-sorcery = { path = "crates/event-sorcery", features = [
  "test-support",
] }
st0x-evm = { workspace = true, features = ["local-signer"] }
st0x-execution = { path = "crates/execution", features = [
  "mock",
  "test-support",
] }
tempfile = "3.24.0"
tracing-test = "0.2.5"
bon = "3.9.0"
st0x-hedge = { path = ".", features = ["test-support"] }
test-log = { version = "0.2.19", features = ["trace"] }
approx = "0.5.1"
rsa.workspace = true

[lints]
workspace = true
